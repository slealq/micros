;; ===========================================================================
;; Autor: Stuart Leal Q
;; Fecha: 12 de Noviembre de 2019
;; Version: 1.0
;; ===========================================================================

#include registers.inc

;; ===========================================================================
;; ==================== DECLARACION DE ESTRUCTURAS DE DATOS ==================
;; ===========================================================================

                        org $1000

NIVEL_PROM:             ds 1          

;; ===========================================================================
;; ==================== DECLARACION DE INTERRUPCIONES ========================
;; ===========================================================================

                        org $3E52
                        dw ATD0_ISR                 

;; ===========================================================================
;; ==================== CODIFICACION HARDWARE ================================
;; ===========================================================================

                        org $2000
                        lds #$3bff

Main                    ldab 200
                        movb #$82 ATD0CTL2

MN_wait_10us            decb
                        cmpb #0
                        beq MN_After_10us

                        bra MN_wait_10us

MN_After_10us           movb #$30 ATD0CTL3
                        movb #$10 ATD0CTL4
                        movb #$87 ATD0CTL5

                        cli                        

;; ===========================================================================
;; ==================== INICIALIZACIÃ“N ESTRUCTURAS ===========================
;; ===========================================================================


;; ===========================================================================
;; ==================== PROGRAMA PRINCIPAL ===================================
;; ===========================================================================
                                 

MN_fin                  bra *

;; ==================== Subrutina ATD0_ISR ===================================

ATD0_ISR                ldd ADR00H
                        addd ADR01H
                        addd ADR02H
                        addd ADR03H
                        addd ADR04H
                        addd ADR05H
                        ldx #6
                        idiv
                        stx NIVEL_PROM
                        movb #$87 ATD0CTL5

                        rti

;; ==================== Subrutina CALCULO ====================================

CALCULO                 


